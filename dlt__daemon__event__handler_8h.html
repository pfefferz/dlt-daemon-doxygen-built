<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>automotive-dlt: /home/pfefferz/dlt-daemon/src/daemon/dlt_daemon_event_handler.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">automotive-dlt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dlt__daemon__event__handler_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dlt_daemon_event_handler.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/epoll.h&gt;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__connection__types_8h_source.html">dlt_daemon_connection_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__event__handler__types_8h_source.html">dlt_daemon_event_handler_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt-daemon_8h_source.html">dlt-daemon.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dlt_daemon_event_handler.h:</div>
<div class="dyncontent">
<div class="center"><img src="dlt__daemon__event__handler_8h__incl.png" border="0" usemap="#_2home_2pfefferz_2dlt-daemon_2src_2daemon_2dlt__daemon__event__handler_8h" alt=""/></div>
<!-- MAP 0 -->
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="dlt__daemon__event__handler_8h__dep__incl.png" border="0" usemap="#_2home_2pfefferz_2dlt-daemon_2src_2daemon_2dlt__daemon__event__handler_8hdep" alt=""/></div>
<!-- MAP 1 -->
</div>
</div>
<p><a href="dlt__daemon__event__handler_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9235463bdea586f45b2d0319622be4aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a9235463bdea586f45b2d0319622be4aa">dlt_daemon_prepare_event_handling</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *)</td></tr>
<tr class="memdesc:a9235463bdea586f45b2d0319622be4aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare the event handler.  <a href="#a9235463bdea586f45b2d0319622be4aa">More...</a><br /></td></tr>
<tr class="separator:a9235463bdea586f45b2d0319622be4aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09fd5ef25791e069af54dd9fb26f648"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#af09fd5ef25791e069af54dd9fb26f648">dlt_daemon_handle_event</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, <a class="el" href="struct_dlt_daemon.html">DltDaemon</a> *, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *)</td></tr>
<tr class="memdesc:af09fd5ef25791e069af54dd9fb26f648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Catch and process incoming events.  <a href="#af09fd5ef25791e069af54dd9fb26f648">More...</a><br /></td></tr>
<tr class="separator:af09fd5ef25791e069af54dd9fb26f648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342b9e8c7ef992ece0e9c0468327d7ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a342b9e8c7ef992ece0e9c0468327d7ee">dlt_event_handler_find_connection_by_id</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, <a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a>)</td></tr>
<tr class="memdesc:a342b9e8c7ef992ece0e9c0468327d7ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find connection with a specific <em>id</em> in the connection list.  <a href="#a342b9e8c7ef992ece0e9c0468327d7ee">More...</a><br /></td></tr>
<tr class="separator:a342b9e8c7ef992ece0e9c0468327d7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1f20087b931dae353cde6aa67d296f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a3d1f20087b931dae353cde6aa67d296f">dlt_event_handler_find_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, int)</td></tr>
<tr class="memdesc:a3d1f20087b931dae353cde6aa67d296f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find connection with a specific <em>fd</em> in the connection list.  <a href="#a3d1f20087b931dae353cde6aa67d296f">More...</a><br /></td></tr>
<tr class="separator:a3d1f20087b931dae353cde6aa67d296f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c0fa73bbb420c44b9d821cbac8bab8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a0c0fa73bbb420c44b9d821cbac8bab8f">dlt_event_handler_cleanup_connections</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *)</td></tr>
<tr class="memdesc:a0c0fa73bbb420c44b9d821cbac8bab8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the connection list.  <a href="#a0c0fa73bbb420c44b9d821cbac8bab8f">More...</a><br /></td></tr>
<tr class="separator:a0c0fa73bbb420c44b9d821cbac8bab8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2247658a7fd7cd4b594eae335d052f56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a2247658a7fd7cd4b594eae335d052f56">dlt_event_handler_register_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *, int)</td></tr>
<tr class="memdesc:a2247658a7fd7cd4b594eae335d052f56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a connection for event handling and takes its ownership.  <a href="#a2247658a7fd7cd4b594eae335d052f56">More...</a><br /></td></tr>
<tr class="separator:a2247658a7fd7cd4b594eae335d052f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cd6f7f2ffd11e8691d2951d6f5073cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#a9cd6f7f2ffd11e8691d2951d6f5073cb">dlt_event_handler_unregister_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *, int)</td></tr>
<tr class="memdesc:a9cd6f7f2ffd11e8691d2951d6f5073cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregisters a connection from the event handler and destroys it.  <a href="#a9cd6f7f2ffd11e8691d2951d6f5073cb">More...</a><br /></td></tr>
<tr class="separator:a9cd6f7f2ffd11e8691d2951d6f5073cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d4dc59f4b3a0dcd518f52025c5a8dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8h.html#ae2d4dc59f4b3a0dcd518f52025c5a8dc">dlt_connection_check_activate</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *, int)</td></tr>
<tr class="memdesc:ae2d4dc59f4b3a0dcd518f52025c5a8dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for connection activation.  <a href="#ae2d4dc59f4b3a0dcd518f52025c5a8dc">More...</a><br /></td></tr>
<tr class="separator:ae2d4dc59f4b3a0dcd518f52025c5a8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Frederic Berat <a href="#" onclick="location.href='mai'+'lto:'+'fbe'+'ra'+'t@d'+'e.'+'adi'+'t-'+'jv.'+'co'+'m'; return false;">fbera<span style="display: none;">.nosp@m.</span>t@de<span style="display: none;">.nosp@m.</span>.adit<span style="display: none;">.nosp@m.</span>-jv.<span style="display: none;">.nosp@m.</span>com</a></dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright Â© 2015 Advanced Driver Information Technology. <br />
License MPL-2.0: Mozilla Public License version 2.0 <a href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. </dd></dl>

<p>Definition in file <a class="el" href="dlt__daemon__event__handler_8h_source.html">dlt_daemon_event_handler.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae2d4dc59f4b3a0dcd518f52025c5a8dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_connection_check_activate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>activation_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for connection activation. </p>
<p>If the connection is active and it's not allowed anymore or it the user ask for deactivation, the connection will be deactivated. If the connection is inactive, the user asks for activation and it's allowed for it to be activated, the connection will be activated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure. </td></tr>
    <tr><td class="paramname">con</td><td>The connection to act on </td></tr>
    <tr><td class="paramname">activation_type</td><td>The type of activation requested ((DE)ACTIVATE)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">335</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00039">ACTIVATE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00037">ACTIVE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00038">DEACTIVATE</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00092">DLT_DAEMON_TEXTBUFSIZE</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00081">DltConnection::ev_mask</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00036">INACTIVE</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00079">DltConnection::status</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">dlt_event_handler_register_connection()</a>, and <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="af09fd5ef25791e069af54dd9fb26f648"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_daemon_handle_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>pEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon.html">DltDaemon</a> *&#160;</td>
          <td class="paramname"><em>daemon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Catch and process incoming events. </p>
<p>This function waits for events on all connections. Once an event raise, the callback for the specific connection is called, or the connection is destroyed if a hangup occurs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">daemon</td><td>Structure to be passed to the callback. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">pEvent</td><td>Event handler structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. May be interrupted. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">91</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection_8c_source.html#l00257">dlt_connection_get_callback()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00054">DLT_CONNECTION_TYPE_MAX</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00092">DLT_DAEMON_TEXTBUFSIZE</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00053">DLT_EPOLL_MAX_EVENTS</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00052">DLT_EPOLL_TIMEOUT_MSEC</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00226">dlt_event_handler_find_connection_by_id()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00056">DltEventHandler::events</a>, <a class="el" href="dlt-daemon_8h_source.html#l00138">DltDaemonLocal::flags</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt-daemon_8c_source.html#l00080">str</a>, and <a class="el" href="dlt-daemon_8h_source.html#l00092">DltDaemonFlags::vflag</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l00583">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a9235463bdea586f45b2d0319622be4aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_daemon_prepare_event_handling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare the event handler. </p>
<p>This will create the epoll file descriptor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler to prepare.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00062">62</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00053">DLT_EPOLL_MAX_EVENTS</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l00583">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c0fa73bbb420c44b9d821cbac8bab8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dlt_event_handler_cleanup_connections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the connection list. </p>
<p>This function runs through the connection list and destroy them one by one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>Pointer to the event handler structure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00287">287</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">dlt_daemon_remove_connection()</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l01200">dlt_daemon_local_cleanup()</a>.</p>

</div>
</div>
<a class="anchor" id="a3d1f20087b931dae353cde6aa67d296f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_dlt_connection.html">DltConnection</a>* dlt_event_handler_find_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find connection with a specific <em>fd</em> in the connection list. </p>
<p>There can be only one event per <em>fd</em>. We can then find a specific connection based on this <em>fd</em>. That allows to check if a specific <em>fd</em> has already been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the list of connection is. </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor of the connection to be found.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The found connection pointer, NULL otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00201">201</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>, and <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="a342b9e8c7ef992ece0e9c0468327d7ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_dlt_connection.html">DltConnection</a>* dlt_event_handler_find_connection_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a>&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find connection with a specific <em>id</em> in the connection list. </p>
<p>There can be only one event per <em>fd</em>. We can then find a specific connection based on this <em>fd</em>. That allows to check if a specific <em>fd</em> has already been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the list of connection is. </td></tr>
    <tr><td class="paramname">id</td><td>The identifier of the connection to be found.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The found connection pointer, NULL otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00226">226</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a2247658a7fd7cd4b594eae335d052f56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_event_handler_register_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a connection for event handling and takes its ownership. </p>
<p>As we add the connection to the list of connection, we take its ownership. That's the only place where the connection pointer is stored. The connection is then used to create a new event trigger. If the connection is of type DLT_CONNECTION_CLIENT_MSG_TCP, we increase the daemon_local-&gt;client_connections counter. TODO: Move this counter inside the event handler structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure where the connection list is. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">connection</td><td>The connection to be registered. </td></tr>
    <tr><td class="paramname">mask</td><td>The bit mask of event to be registered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">429</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00039">ACTIVATE</a>, <a class="el" href="dlt-daemon_8h_source.html#l00143">DltDaemonLocal::client_connections</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">dlt_connection_check_activate()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00309">dlt_daemon_add_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00081">DltConnection::ev_mask</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00036">INACTIVE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00079">DltConnection::status</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a9cd6f7f2ffd11e8691d2951d6f5073cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_event_handler_unregister_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregisters a connection from the event handler and destroys it. </p>
<p>We first look for the connection to be unregistered, delete the event corresponding and then destroy the connection. If the connection is of type DLT_CONNECTION_CLIENT_MSG_TCP, we decrease the daemon_local-&gt;client_connections counter. TODO: Move this counter inside the event handler structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure where the connection list is. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor of the connection to be unregistered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">472</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt-daemon_8h_source.html#l00143">DltDaemonLocal::client_connections</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00038">DEACTIVATE</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">dlt_connection_check_activate()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">dlt_daemon_remove_connection()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00201">dlt_event_handler_find_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l03222">dlt_daemon_close_socket()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>, <a class="el" href="dlt__gateway_8c_source.html#l01034">dlt_gateway_process_on_demand_request()</a>, and <a class="el" href="dlt__gateway_8c_source.html#l00731">dlt_gateway_process_passive_node_messages()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2d094300ae4f2c55dd459b9ec7dd0ad3.html">daemon</a></li><li class="navelem"><a class="el" href="dlt__daemon__event__handler_8h.html">dlt_daemon_event_handler.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
