<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>automotive-dlt: /home/pfefferz/dlt-daemon/src/daemon/dlt_daemon_connection.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">automotive-dlt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dlt__daemon__connection_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dlt_daemon_connection.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;sys/syslog.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__connection__types_8h_source.html">dlt_daemon_connection_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__connection_8h_source.html">dlt_daemon_connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__event__handler__types_8h_source.html">dlt_daemon_event_handler_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__event__handler_8h_source.html">dlt_daemon_event_handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt-daemon_8h_source.html">dlt-daemon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt-daemon__cfg_8h_source.html">dlt-daemon_cfg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__common_8h_source.html">dlt_daemon_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__common_8h_source.html">dlt_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__gateway_8h_source.html">dlt_gateway.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__socket_8h_source.html">dlt_daemon_socket.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dlt_daemon_connection.c:</div>
<div class="dyncontent">
<div class="center"><img src="dlt__daemon__connection_8c__incl.png" border="0" usemap="#_2home_2pfefferz_2dlt-daemon_2src_2daemon_2dlt__daemon__connection_8c" alt=""/></div>
<!-- MAP 0 -->
</div>
</div>
<p><a href="dlt__daemon__connection_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a81f915f5ed2a463338e0f3d717678ecc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#a81f915f5ed2a463338e0f3d717678ecc">dlt_connection_send</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *conn, void *msg, size_t msg_size)</td></tr>
<tr class="memdesc:a81f915f5ed2a463338e0f3d717678ecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic sending function.  <a href="#a81f915f5ed2a463338e0f3d717678ecc">More...</a><br /></td></tr>
<tr class="separator:a81f915f5ed2a463338e0f3d717678ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a684ca191b7702793edac8351ccbcef3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#a684ca191b7702793edac8351ccbcef3d">dlt_connection_send_multiple</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *con, void *data1, int size1, void *data2, int size2, int sendserialheader)</td></tr>
<tr class="memdesc:a684ca191b7702793edac8351ccbcef3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send up to two messages through a connection.  <a href="#a684ca191b7702793edac8351ccbcef3d">More...</a><br /></td></tr>
<tr class="separator:a684ca191b7702793edac8351ccbcef3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191f6cd343692e8af21ad719ab91c313"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#a191f6cd343692e8af21ad719ab91c313">dlt_connection_get_next</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *current, int type_mask)</td></tr>
<tr class="memdesc:a191f6cd343692e8af21ad719ab91c313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the next connection filtered with a type mask.  <a href="#a191f6cd343692e8af21ad719ab91c313">More...</a><br /></td></tr>
<tr class="separator:a191f6cd343692e8af21ad719ab91c313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8aa81f6f276cd1c84d7daa8bdb0460a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#ae8aa81f6f276cd1c84d7daa8bdb0460a">dlt_connection_destroy_receiver</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *con)</td></tr>
<tr class="separator:ae8aa81f6f276cd1c84d7daa8bdb0460a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f6e2b3aa4025d962ba4ecc648e81530"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> <a class="el" href="struct_dlt_receiver.html">DltReceiver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#a1f6e2b3aa4025d962ba4ecc648e81530">dlt_connection_get_receiver</a> (<a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *daemon_local, <a class="el" href="dlt__daemon__connection__types_8h.html#afe83875b27b4fe0397b809b04a541204">DltConnectionType</a> type, int fd)</td></tr>
<tr class="memdesc:a1f6e2b3aa4025d962ba4ecc648e81530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the receiver structure associated to a connection.  <a href="#a1f6e2b3aa4025d962ba4ecc648e81530">More...</a><br /></td></tr>
<tr class="separator:a1f6e2b3aa4025d962ba4ecc648e81530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a8a63aeaaded148b5d79e3397ae3cfa"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#a7a8a63aeaaded148b5d79e3397ae3cfa">dlt_connection_get_callback</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *con)</td></tr>
<tr class="memdesc:a7a8a63aeaaded148b5d79e3397ae3cfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the callback from a specific connection.  <a href="#a7a8a63aeaaded148b5d79e3397ae3cfa">More...</a><br /></td></tr>
<tr class="separator:a7a8a63aeaaded148b5d79e3397ae3cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1dfa18166d772fc1d1eb74db4ff0d36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#ac1dfa18166d772fc1d1eb74db4ff0d36">dlt_connection_destroy</a> (<a class="el" href="struct_dlt_connection.html">DltConnection</a> *to_destroy)</td></tr>
<tr class="memdesc:ac1dfa18166d772fc1d1eb74db4ff0d36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys a connection.  <a href="#ac1dfa18166d772fc1d1eb74db4ff0d36">More...</a><br /></td></tr>
<tr class="separator:ac1dfa18166d772fc1d1eb74db4ff0d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7620d853ab4e0887a3e74e9bd5477f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#ad7620d853ab4e0887a3e74e9bd5477f2">dlt_connection_create</a> (<a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *daemon_local, <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *evh, int fd, int mask, <a class="el" href="dlt__daemon__connection__types_8h.html#afe83875b27b4fe0397b809b04a541204">DltConnectionType</a> type)</td></tr>
<tr class="memdesc:ad7620d853ab4e0887a3e74e9bd5477f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a connection and registers it to the <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a>.  <a href="#ad7620d853ab4e0887a3e74e9bd5477f2">More...</a><br /></td></tr>
<tr class="separator:ad7620d853ab4e0887a3e74e9bd5477f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa79c9e53c82387eb92e99235c1999c34"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__connection_8c.html#aa79c9e53c82387eb92e99235c1999c34">connectionId</a></td></tr>
<tr class="separator:aa79c9e53c82387eb92e99235c1999c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Frederic Berat <a href="#" onclick="location.href='mai'+'lto:'+'fbe'+'ra'+'t@d'+'e.'+'adi'+'t-'+'jv.'+'co'+'m'; return false;">fbera<span style="display: none;">.nosp@m.</span>t@de<span style="display: none;">.nosp@m.</span>.adit<span style="display: none;">.nosp@m.</span>-jv.<span style="display: none;">.nosp@m.</span>com</a></dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright Â© 2015 Advanced Driver Information Technology. <br />
License MPL-2.0: Mozilla Public License version 2.0 <a href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. </dd></dl>

<p>Definition in file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad7620d853ab4e0887a3e74e9bd5477f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_connection_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dlt__daemon__connection__types_8h.html#afe83875b27b4fe0397b809b04a541204">DltConnectionType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a connection and registers it to the <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a>. </p>
<p>The function will allocate memory for the connection, and give the pointer to the <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> in order to register it for incoming events. The connection is then destroyed later on, once it's not needed anymore or it the event handler is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">daemon_local</td><td>Structure were some needed information is. </td></tr>
    <tr><td class="paramname">evh</td><td><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> to register the connection to. </td></tr>
    <tr><td class="paramname">fd</td><td>File descriptor of the connection. </td></tr>
    <tr><td class="paramname">mask</td><td>Event list bit mask. </td></tr>
    <tr><td class="paramname">type</td><td>Connection type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 On success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">346</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00037">ACTIVE</a>, <a class="el" href="dlt__daemon__connection_8c_source.html#l00051">connectionId</a>, <a class="el" href="dlt__daemon__connection_8c_source.html#l00193">dlt_connection_get_receiver()</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00092">DLT_DAEMON_TEXTBUFSIZE</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00201">dlt_event_handler_find_connection()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">dlt_event_handler_register_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00079">DltConnection::status</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l03142">create_timer_fd()</a>, <a class="el" href="dlt-daemon_8c_source.html#l00996">dlt_daemon_init_fifo()</a>, <a class="el" href="dlt-daemon_8c_source.html#l00924">dlt_daemon_init_serial()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01067">dlt_daemon_local_connection_init()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01477">dlt_daemon_process_client_connect()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01761">dlt_daemon_process_control_connect()</a>, <a class="el" href="dlt__gateway_8c_source.html#l00636">dlt_gateway_establish_connections()</a>, and <a class="el" href="dlt__gateway_8c_source.html#l01034">dlt_gateway_process_on_demand_request()</a>.</p>

</div>
</div>
<a class="anchor" id="ac1dfa18166d772fc1d1eb74db4ff0d36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dlt_connection_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>to_destroy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys a connection. </p>
<p>This function closes and frees the corresponding connection. This is expected to be called by the connection owner: the <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a>. Ownership of the connection is given during the registration to the <a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">to_destroy</td><td>Connection to be destroyed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00320">320</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection_8c_source.html#l00161">dlt_connection_destroy_receiver()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00054">DLT_CONNECTION_TYPE_MAX</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">dlt_daemon_remove_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="ae8aa81f6f276cd1c84d7daa8bdb0460a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> void dlt_connection_destroy_receiver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00161">161</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00052">DLT_CONNECTION_GATEWAY</a>, <a class="el" href="dlt__common_8c_source.html#l02153">dlt_receiver_free()</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00320">dlt_connection_destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="a7a8a63aeaaded148b5d79e3397ae3cfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* dlt_connection_get_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>con</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the callback from a specific connection. </p>
<p>The callback retrieved that way is used to handle event for this connection. It as been chosen to proceed that way instead of having the callback directly in the structure in order to have some way to check that the structure is still valid, or at least gracefully handle errors instead of crashing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>The connection to retrieve the callback from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Function pointer or NULL. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00257">257</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00046">DLT_CONNECTION_APP_MSG</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00043">DLT_CONNECTION_CLIENT_CONNECT</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00050">DLT_CONNECTION_CONTROL_CONNECT</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00051">DLT_CONNECTION_CONTROL_MSG</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00052">DLT_CONNECTION_GATEWAY</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00053">DLT_CONNECTION_GATEWAY_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00047">DLT_CONNECTION_ONE_S_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00048">DLT_CONNECTION_SIXTY_S_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00049">DLT_CONNECTION_SYSTEMD_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00054">DLT_CONNECTION_TYPE_MAX</a>, <a class="el" href="dlt-daemon_8c_source.html#l01477">dlt_daemon_process_client_connect()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01593">dlt_daemon_process_client_messages()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01681">dlt_daemon_process_client_messages_serial()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01761">dlt_daemon_process_control_connect()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01817">dlt_daemon_process_control_messages()</a>, <a class="el" href="dlt__daemon__client_8c_source.html#l01941">dlt_daemon_process_one_s_timer()</a>, <a class="el" href="dlt__daemon__client_8c_source.html#l02000">dlt_daemon_process_sixty_s_timer()</a>, <a class="el" href="dlt__daemon__client_8c_source.html#l02107">dlt_daemon_process_systemd_timer()</a>, <a class="el" href="dlt-daemon_8c_source.html#l01948">dlt_daemon_process_user_messages()</a>, <a class="el" href="dlt__gateway_8c_source.html#l00914">dlt_gateway_process_gateway_timer()</a>, <a class="el" href="dlt__gateway_8c_source.html#l00731">dlt_gateway_process_passive_node_messages()</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a191f6cd343692e8af21ad719ab91c313"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_dlt_connection.html">DltConnection</a>* dlt_connection_get_next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the next connection filtered with a type mask. </p>
<p>In some cases we need the next connection available of a specific type or specific different types. This function returns the next available connection that is of one of the types included in the mask. The current connection can be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current</td><td>The current connection pointer. </td></tr>
    <tr><td class="paramname">type_mask</td><td>A bit mask representing the connection types to be filtered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next available connection of the considered types or NULL. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00151">151</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__client_8c_source.html#l00101">dlt_daemon_client_send_all_multiple()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f6e2b3aa4025d962ba4ecc648e81530"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> <a class="el" href="struct_dlt_receiver.html">DltReceiver</a>* dlt_connection_get_receiver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dlt__daemon__connection__types_8h.html#afe83875b27b4fe0397b809b04a541204">DltConnectionType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the receiver structure associated to a connection. </p>
<p>The receiver structure is sometimes needed while handling the event. This behavior is mainly due to the fact that it's not intended to modify the whole design of the daemon while implementing the new event handling. Based on the connection type provided, this function returns the pointer to the <a class="el" href="struct_dlt_receiver.html">DltReceiver</a> structure corresponding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dameon_local</td><td>Structure where to take the <a class="el" href="struct_dlt_receiver.html">DltReceiver</a> pointer from. </td></tr>
    <tr><td class="paramname">type</td><td>Type of the connection. </td></tr>
    <tr><td class="paramname">fd</td><td>File descriptor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_dlt_receiver.html">DltReceiver</a> structure or NULL if none corresponds to the type. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00193">193</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00046">DLT_CONNECTION_APP_MSG</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00043">DLT_CONNECTION_CLIENT_CONNECT</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00050">DLT_CONNECTION_CONTROL_CONNECT</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00051">DLT_CONNECTION_CONTROL_MSG</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00052">DLT_CONNECTION_GATEWAY</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00053">DLT_CONNECTION_GATEWAY_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00047">DLT_CONNECTION_ONE_S_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00048">DLT_CONNECTION_SIXTY_S_TIMER</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00049">DLT_CONNECTION_SYSTEMD_TIMER</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00082">DLT_DAEMON_RCVBUFSIZE</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00086">DLT_DAEMON_RCVBUFSIZESERIAL</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00084">DLT_DAEMON_RCVBUFSIZESOCK</a>, <a class="el" href="dlt__gateway_8c_source.html#l00710">dlt_gateway_get_connection_receiver()</a>, <a class="el" href="dlt__common_8c_source.html#l02126">dlt_receiver_init()</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt-daemon_8h_source.html#l00141">DltDaemonLocal::pGateway</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a81f915f5ed2a463338e0f3d717678ecc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> int dlt_connection_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>msg_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic sending function. </p>
<p>We manage different type of connection which have similar send/write functions. We can then abstract the data transfer using this function, moreover as we often transfer data to different kind of connection within the same loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>The connection structure. </td></tr>
    <tr><td class="paramname">msg</td><td>The message buffer to be sent </td></tr>
    <tr><td class="paramname">msg_size</td><td>The length of the message to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The amount of bytes send on success, -1 otherwise. errno is appropriately set. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00067">67</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00054">DLT_CONNECTION_TYPE_MAX</a>, <a class="el" href="dlt-daemon_8h_source.html#l00170">DLT_DAEMON_ERROR_OK</a>, <a class="el" href="dlt-daemon_8h_source.html#l00171">DLT_DAEMON_ERROR_UNKNOWN</a>, <a class="el" href="dlt__daemon__socket_8c_source.html#l00176">dlt_daemon_socket_sendreliable()</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00105">dlt_connection_send_multiple()</a>.</p>

</div>
</div>
<a class="anchor" id="a684ca191b7702793edac8351ccbcef3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_connection_send_multiple </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sendserialheader</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send up to two messages through a connection. </p>
<p>We often need to send 2 messages through a specific connection, plus the serial header. This function groups these different calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con</td><td>The connection to send the messages through. </td></tr>
    <tr><td class="paramname">data1</td><td>The first message to be sent. </td></tr>
    <tr><td class="paramname">size1</td><td>The size of the first message. </td></tr>
    <tr><td class="paramname">data2</td><td>The second message to be send. </td></tr>
    <tr><td class="paramname">size2</td><td>The second message size. </td></tr>
    <tr><td class="paramname">sendserialheader</td><td>Whether we need or not to send the serial header.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DLT_DAEMON_ERROR_OK on success, -1 otherwise. errno is properly set. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00105">105</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection_8c_source.html#l00067">dlt_connection_send()</a>, <a class="el" href="dlt-daemon_8h_source.html#l00171">DLT_DAEMON_ERROR_UNKNOWN</a>, <a class="el" href="dlt__types_8h_source.html#l00095">DLT_RETURN_OK</a>, <a class="el" href="dlt__common_8c_source.html#l00070">dltSerialHeader</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__client_8c_source.html#l00101">dlt_daemon_client_send_all_multiple()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="aa79c9e53c82387eb92e99235c1999c34"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a> connectionId</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="dlt__daemon__connection_8c_source.html#l00051">51</a> of file <a class="el" href="dlt__daemon__connection_8c_source.html">dlt_daemon_connection.c</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2d094300ae4f2c55dd459b9ec7dd0ad3.html">daemon</a></li><li class="navelem"><a class="el" href="dlt__daemon__connection_8c.html">dlt_daemon_connection.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
