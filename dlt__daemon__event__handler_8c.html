<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>automotive-dlt: /home/pfefferz/dlt-daemon/src/daemon/dlt_daemon_event_handler.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">automotive-dlt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dlt__daemon__event__handler_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dlt_daemon_event_handler.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;sys/epoll.h&gt;</code><br />
<code>#include &lt;sys/syslog.h&gt;</code><br />
<code>#include &quot;<a class="el" href="dlt__common_8h_source.html">dlt_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt-daemon_8h_source.html">dlt-daemon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt-daemon__cfg_8h_source.html">dlt-daemon_cfg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__common_8h_source.html">dlt_daemon_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__connection_8h_source.html">dlt_daemon_connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__connection__types_8h_source.html">dlt_daemon_connection_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__event__handler_8h_source.html">dlt_daemon_event_handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dlt__daemon__event__handler__types_8h_source.html">dlt_daemon_event_handler_types.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dlt_daemon_event_handler.c:</div>
<div class="dyncontent">
<div class="center"><img src="dlt__daemon__event__handler_8c__incl.png" border="0" usemap="#_2home_2pfefferz_2dlt-daemon_2src_2daemon_2dlt__daemon__event__handler_8c" alt=""/></div>
<!-- MAP 0 -->
</div>
</div>
<p><a href="dlt__daemon__event__handler_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae1c9c8350e5289e077f5641de5801c75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#ae1c9c8350e5289e077f5641de5801c75">DLT_EPOLL_TIMEOUT_MSEC</a>&#160;&#160;&#160;1000</td></tr>
<tr class="separator:ae1c9c8350e5289e077f5641de5801c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aad9e3fd56bfdc9b4c52da3b8441bbf1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#aad9e3fd56bfdc9b4c52da3b8441bbf1e">dlt_daemon_prepare_event_handling</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev)</td></tr>
<tr class="memdesc:aad9e3fd56bfdc9b4c52da3b8441bbf1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare the event handler.  <a href="#aad9e3fd56bfdc9b4c52da3b8441bbf1e">More...</a><br /></td></tr>
<tr class="separator:aad9e3fd56bfdc9b4c52da3b8441bbf1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac0f4db06b6b7d808dd14d263ab584b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#aac0f4db06b6b7d808dd14d263ab584b1">dlt_daemon_handle_event</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *pEvent, <a class="el" href="struct_dlt_daemon.html">DltDaemon</a> *daemon, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *daemon_local)</td></tr>
<tr class="memdesc:aac0f4db06b6b7d808dd14d263ab584b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Catch and process incoming events.  <a href="#aac0f4db06b6b7d808dd14d263ab584b1">More...</a><br /></td></tr>
<tr class="separator:aac0f4db06b6b7d808dd14d263ab584b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd033af8123c428cd05afbfeb349854"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a1bd033af8123c428cd05afbfeb349854">dlt_event_handler_find_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev, int fd)</td></tr>
<tr class="memdesc:a1bd033af8123c428cd05afbfeb349854"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find connection with a specific <em>fd</em> in the connection list.  <a href="#a1bd033af8123c428cd05afbfeb349854">More...</a><br /></td></tr>
<tr class="separator:a1bd033af8123c428cd05afbfeb349854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cff65ae50cf384674d7784b77cae11f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a3cff65ae50cf384674d7784b77cae11f">dlt_event_handler_find_connection_by_id</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev, <a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a> id)</td></tr>
<tr class="memdesc:a3cff65ae50cf384674d7784b77cae11f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find connection with a specific <em>id</em> in the connection list.  <a href="#a3cff65ae50cf384674d7784b77cae11f">More...</a><br /></td></tr>
<tr class="separator:a3cff65ae50cf384674d7784b77cae11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195fe3c17aa62a275dfffe1e0ce0fa7a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a195fe3c17aa62a275dfffe1e0ce0fa7a">dlt_daemon_remove_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *to_remove)</td></tr>
<tr class="memdesc:a195fe3c17aa62a275dfffe1e0ce0fa7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a connection from the list and destroy it.  <a href="#a195fe3c17aa62a275dfffe1e0ce0fa7a">More...</a><br /></td></tr>
<tr class="separator:a195fe3c17aa62a275dfffe1e0ce0fa7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f851474ec8d9c0a1a7ccef78168bedf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a0f851474ec8d9c0a1a7ccef78168bedf">dlt_event_handler_cleanup_connections</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev)</td></tr>
<tr class="memdesc:a0f851474ec8d9c0a1a7ccef78168bedf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the connection list.  <a href="#a0f851474ec8d9c0a1a7ccef78168bedf">More...</a><br /></td></tr>
<tr class="separator:a0f851474ec8d9c0a1a7ccef78168bedf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82a64c735538dc40e9165621f0c87753"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a82a64c735538dc40e9165621f0c87753">dlt_daemon_add_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *ev, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *connection)</td></tr>
<tr class="memdesc:a82a64c735538dc40e9165621f0c87753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new connection to the list.  <a href="#a82a64c735538dc40e9165621f0c87753">More...</a><br /></td></tr>
<tr class="separator:a82a64c735538dc40e9165621f0c87753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6931819d3d6cc937bade2d3b865823"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#abd6931819d3d6cc937bade2d3b865823">dlt_connection_check_activate</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *evhdl, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *con, int activation_type)</td></tr>
<tr class="memdesc:abd6931819d3d6cc937bade2d3b865823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for connection activation.  <a href="#abd6931819d3d6cc937bade2d3b865823">More...</a><br /></td></tr>
<tr class="separator:abd6931819d3d6cc937bade2d3b865823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2a02df2b27dc6c7a0cbed1e2feb090"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#a5c2a02df2b27dc6c7a0cbed1e2feb090">dlt_event_handler_register_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *evhdl, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *daemon_local, <a class="el" href="struct_dlt_connection.html">DltConnection</a> *connection, int mask)</td></tr>
<tr class="memdesc:a5c2a02df2b27dc6c7a0cbed1e2feb090"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a connection for event handling and takes its ownership.  <a href="#a5c2a02df2b27dc6c7a0cbed1e2feb090">More...</a><br /></td></tr>
<tr class="separator:a5c2a02df2b27dc6c7a0cbed1e2feb090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea6a34bbdeb3f8817e3461206929931a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dlt__daemon__event__handler_8c.html#aea6a34bbdeb3f8817e3461206929931a">dlt_event_handler_unregister_connection</a> (<a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *evhdl, <a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *daemon_local, int fd)</td></tr>
<tr class="memdesc:aea6a34bbdeb3f8817e3461206929931a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregisters a connection from the event handler and destroys it.  <a href="#aea6a34bbdeb3f8817e3461206929931a">More...</a><br /></td></tr>
<tr class="separator:aea6a34bbdeb3f8817e3461206929931a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Frederic Berat <a href="#" onclick="location.href='mai'+'lto:'+'fbe'+'ra'+'t@d'+'e.'+'adi'+'t-'+'jv.'+'co'+'m'; return false;">fbera<span style="display: none;">.nosp@m.</span>t@de<span style="display: none;">.nosp@m.</span>.adit<span style="display: none;">.nosp@m.</span>-jv.<span style="display: none;">.nosp@m.</span>com</a></dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright © 2015 Advanced Driver Information Technology. <br />
License MPL-2.0: Mozilla Public License version 2.0 <a href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. </dd></dl>

<p>Definition in file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ae1c9c8350e5289e077f5641de5801c75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DLT_EPOLL_TIMEOUT_MSEC&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The maximum amount of time to wait for an epoll event. Set to 1 second to avoid unnecessary wake ups. </p>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00052">52</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="abd6931819d3d6cc937bade2d3b865823"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_connection_check_activate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>activation_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for connection activation. </p>
<p>If the connection is active and it's not allowed anymore or it the user ask for deactivation, the connection will be deactivated. If the connection is inactive, the user asks for activation and it's allowed for it to be activated, the connection will be activated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure. </td></tr>
    <tr><td class="paramname">con</td><td>The connection to act on </td></tr>
    <tr><td class="paramname">activation_type</td><td>The type of activation requested ((DE)ACTIVATE)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">335</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00039">ACTIVATE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00037">ACTIVE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00038">DEACTIVATE</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00092">DLT_DAEMON_TEXTBUFSIZE</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00081">DltConnection::ev_mask</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00036">INACTIVE</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00079">DltConnection::status</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">dlt_event_handler_register_connection()</a>, and <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="a82a64c735538dc40e9165621f0c87753"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> void dlt_daemon_add_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new connection to the list. </p>
<p>The connection is added at the tail of the list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the connection list is. </td></tr>
    <tr><td class="paramname">connection</td><td>The connection to be added. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00309">309</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">dlt_event_handler_register_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="aac0f4db06b6b7d808dd14d263ab584b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_daemon_handle_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>pEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon.html">DltDaemon</a> *&#160;</td>
          <td class="paramname"><em>daemon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Catch and process incoming events. </p>
<p>This function waits for events on all connections. Once an event raise, the callback for the specific connection is called, or the connection is destroyed if a hangup occurs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">daemon</td><td>Structure to be passed to the callback. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">pEvent</td><td>Event handler structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. May be interrupted. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">91</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection_8c_source.html#l00257">dlt_connection_get_callback()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00054">DLT_CONNECTION_TYPE_MAX</a>, <a class="el" href="dlt-daemon__cfg_8h_source.html#l00092">DLT_DAEMON_TEXTBUFSIZE</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00053">DLT_EPOLL_MAX_EVENTS</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00052">DLT_EPOLL_TIMEOUT_MSEC</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00226">dlt_event_handler_find_connection_by_id()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00056">DltEventHandler::events</a>, <a class="el" href="dlt-daemon_8h_source.html#l00138">DltDaemonLocal::flags</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt-daemon_8c_source.html#l00080">str</a>, and <a class="el" href="dlt-daemon_8h_source.html#l00092">DltDaemonFlags::vflag</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l00583">main()</a>.</p>

</div>
</div>
<a class="anchor" id="aad9e3fd56bfdc9b4c52da3b8441bbf1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_daemon_prepare_event_handling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare the event handler. </p>
<p>This will create the epoll file descriptor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler to prepare.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00062">62</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00053">DLT_EPOLL_MAX_EVENTS</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00055">DltEventHandler::epfd</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l00583">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a195fe3c17aa62a275dfffe1e0ce0fa7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__commonapi.html#ga10b2d890d871e1489bb02b7e70d9bdfb">STATIC</a> int dlt_daemon_remove_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>to_remove</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a connection from the list and destroy it. </p>
<p>This function will first look for the connection in the event handler list, remove it from the list and then destroy it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the list of connection is. </td></tr>
    <tr><td class="paramname">to_remove</td><td>The connection to remove from the list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the connection is not found. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">250</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__connection_8c_source.html#l00320">dlt_connection_destroy()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00287">dlt_event_handler_cleanup_connections()</a>, and <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f851474ec8d9c0a1a7ccef78168bedf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dlt_event_handler_cleanup_connections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the connection list. </p>
<p>This function runs through the connection list and destroy them one by one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>Pointer to the event handler structure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00287">287</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">dlt_daemon_remove_connection()</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l01200">dlt_daemon_local_cleanup()</a>.</p>

</div>
</div>
<a class="anchor" id="a1bd033af8123c428cd05afbfeb349854"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_dlt_connection.html">DltConnection</a>* dlt_event_handler_find_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find connection with a specific <em>fd</em> in the connection list. </p>
<p>There can be only one event per <em>fd</em>. We can then find a specific connection based on this <em>fd</em>. That allows to check if a specific <em>fd</em> has already been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the list of connection is. </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor of the connection to be found.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The found connection pointer, NULL otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00201">201</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__common_8h_source.html#l00679">DltReceiver::fd</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>, and <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">dlt_event_handler_unregister_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="a3cff65ae50cf384674d7784b77cae11f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_dlt_connection.html">DltConnection</a>* dlt_event_handler_find_connection_by_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dlt__daemon__connection__types_8h.html#aa1fed33c2e5af36556b571cc8e875ae8">DltConnectionId</a>&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find connection with a specific <em>id</em> in the connection list. </p>
<p>There can be only one event per <em>fd</em>. We can then find a specific connection based on this <em>fd</em>. That allows to check if a specific <em>fd</em> has already been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ev</td><td>The event handler structure where the list of connection is. </td></tr>
    <tr><td class="paramname">id</td><td>The identifier of the connection to be found.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The found connection pointer, NULL otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00226">226</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__event__handler__types_8h_source.html#l00057">DltEventHandler::connections</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00076">DltConnection::id</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, and <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c2a02df2b27dc6c7a0cbed1e2feb090"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_event_handler_register_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_connection.html">DltConnection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a connection for event handling and takes its ownership. </p>
<p>As we add the connection to the list of connection, we take its ownership. That's the only place where the connection pointer is stored. The connection is then used to create a new event trigger. If the connection is of type DLT_CONNECTION_CLIENT_MSG_TCP, we increase the daemon_local-&gt;client_connections counter. TODO: Move this counter inside the event handler structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure where the connection list is. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">connection</td><td>The connection to be registered. </td></tr>
    <tr><td class="paramname">mask</td><td>The bit mask of event to be registered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00429">429</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00039">ACTIVATE</a>, <a class="el" href="dlt-daemon_8h_source.html#l00143">DltDaemonLocal::client_connections</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">dlt_connection_check_activate()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00309">dlt_daemon_add_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00081">DltConnection::ev_mask</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00036">INACTIVE</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00080">DltConnection::next</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00077">DltConnection::receiver</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00079">DltConnection::status</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt__daemon__connection_8c_source.html#l00346">dlt_connection_create()</a>.</p>

</div>
</div>
<a class="anchor" id="aea6a34bbdeb3f8817e3461206929931a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dlt_event_handler_unregister_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dlt_event_handler.html">DltEventHandler</a> *&#160;</td>
          <td class="paramname"><em>evhdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dlt_daemon_local.html">DltDaemonLocal</a> *&#160;</td>
          <td class="paramname"><em>daemon_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregisters a connection from the event handler and destroys it. </p>
<p>We first look for the connection to be unregistered, delete the event corresponding and then destroy the connection. If the connection is of type DLT_CONNECTION_CLIENT_MSG_TCP, we decrease the daemon_local-&gt;client_connections counter. TODO: Move this counter inside the event handler structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evhdl</td><td>The event handler structure where the connection list is. </td></tr>
    <tr><td class="paramname">daemon_local</td><td>Structure containing needed information. </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor of the connection to be unregistered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00472">472</a> of file <a class="el" href="dlt__daemon__event__handler_8c_source.html">dlt_daemon_event_handler.c</a>.</p>

<p>References <a class="el" href="dlt-daemon_8h_source.html#l00143">DltDaemonLocal::client_connections</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00038">DEACTIVATE</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00335">dlt_connection_check_activate()</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00045">DLT_CONNECTION_CLIENT_MSG_SERIAL</a>, <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00044">DLT_CONNECTION_CLIENT_MSG_TCP</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00250">dlt_daemon_remove_connection()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00201">dlt_event_handler_find_connection()</a>, <a class="el" href="dlt__common_8c_source.html#l02029">dlt_log()</a>, <a class="el" href="dlt__types_8h_source.html#l00094">DLT_RETURN_ERROR</a>, <a class="el" href="dlt__common_8h_source.html#l00232">NULL</a>, and <a class="el" href="dlt__daemon__connection__types_8h_source.html#l00078">DltConnection::type</a>.</p>

<p>Referenced by <a class="el" href="dlt-daemon_8c_source.html#l03222">dlt_daemon_close_socket()</a>, <a class="el" href="dlt__daemon__event__handler_8c_source.html#l00091">dlt_daemon_handle_event()</a>, <a class="el" href="dlt__gateway_8c_source.html#l01034">dlt_gateway_process_on_demand_request()</a>, and <a class="el" href="dlt__gateway_8c_source.html#l00731">dlt_gateway_process_passive_node_messages()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2d094300ae4f2c55dd459b9ec7dd0ad3.html">daemon</a></li><li class="navelem"><a class="el" href="dlt__daemon__event__handler_8c.html">dlt_daemon_event_handler.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
